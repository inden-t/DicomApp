# 血管抽出サーフェスモデル構築機能 仕様

## 1. 仕様

### 1.1 概要
この機能は、ユーザーが手動で血管領域を指定し、その領域のみを抽出してサーフェスモデルを構築するものです。これにより、より正確な血管の3Dモデルを生成することが可能になります。

### 1.2 機能要件
1. 血管領域の指定
   - ユーザーは複数のDICOMスライス画像から構成される3次元データ上で、血管領域を3次元塗りつぶし選択で指定できる
   - 指定した領域は保存・編集可能

2. 血管抽出処理
   - 指定された3D領域内のみでサーフェスモデルを生成
   - マーチングキューブ法を使用してモデルを構築
   - 線形補間を使用してモデルを構築

3. モデル表示
   - 生成されたモデルを3Dビューワーで表示
   - 回転、ズーム、パンなどの操作が可能

### 1.3 ユーザーインターフェース要件
1. リボン上の血管領域指定ツール
   - 「血管領域選択」ボタン：血管領域選択モードを開始
   - 「3D塗りつぶし選択」ボタン：3D画像データ上で3次元塗りつぶし選択を実行
   - 「しきい値調整」スライダー：3D塗りつぶし選択のしきい値を調整
   - 「領域編集」ボタン：選択した3D領域の編集モードを開始
   - 「領域削除」ボタン：選択した3D領域を削除
   - 「血管抽出」ボタン：血管抽出処理を開始
   - 「モデル保存」ボタン：生成されたモデルを3Dファイル形式で保存
   - 「選択を破棄して終了」ボタン：血管領域選択モードを終了し、選択状態を破棄

2. 進捗表示
   - モデル生成中の進捗バーとステータス表示

3. 3Dビューワー
   - 生成されたサーフェスモデルの表示
   - 回転、ズーム、パン機能

### 1.4 操作手順

1. DICOMデータの読み込み
   - ユーザーがDICOMファイルを選択し、アプリケーションに読み込む

2. 血管領域選択モードの開始
   - リボン上の「血管領域選択」ボタンをクリック

3. 血管領域の指定
   - 3D画像データ上で3D塗りつぶし選択ツールを使用して血管領域を指定
   - 必要に応じてしきい値を調整
   - 3D領域の編集や削除が可能

4. 血管抽出処理の実行
   - リボン上の「血管抽出」ボタンをクリック

5. 進捗状況の確認
   - 処理中はプログレスバーとステータス表示で進捗を確認

6. 抽出結果の確認
   - 生成されたサーフェスモデルが3Dビューワーに表示される

7. モデルの操作と確認
   - 3Dビューワー上でモデルを回転、ズーム、パンして確認

8. モデルの保存
   - 「モデル保存」ボタンをクリックし、生成されたモデルを適切な3Dファイル形式で保存

## 2. 今後の拡張性

- 2D多角形選択ツールの追加：特定のスライスでより細かい調整が必要な場合に使用
- 自動血管検出アルゴリズムの統合
- 複数の血管領域の個別抽出と色分け表示
- 抽出された血管モデルの測定機能（長さ、直径など）
- 3D領域編集ツールの拡張（例：3Dブラシツール、3Dイレイザーツールなど）
